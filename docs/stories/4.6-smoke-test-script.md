# Story 4.6: Smoke Test Script & Checklist Update

## Status: Not Started

## Context

Currently smoke testing is fully manual with no guidance:

- `docs/dev/smoke-test-plan.md` exists but is outdated (from Story 2.6)
- Publishing checklist references manual smoke test but doesn't point to the plan
- No script to print the checklist - easy to forget it exists

## Objective

Create a `pnpm smoke` command that prints a formatted checklist of manual
tests that Playwright cannot automate, and update the smoke test plan with
Epic 4 features.

## Why Manual Tests Are Needed

Playwright cannot automate these scenarios:

<!-- markdownlint-disable MD013 -->

| Test                                | Limitation                            |
| ----------------------------------- | ------------------------------------- |
| Hotkey with toolbar icon **pinned** | Chrome blocks `chrome.action.openPopup()` |
| Toolbar icon click                  | Same limitation                       |
| Protected chrome:// page            | Chrome blocks extension access in E2E |
| Protected file:// page              | Same limitation                       |

<!-- markdownlint-enable MD013 -->

## Tasks

1. Update `docs/dev/smoke-test-plan.md`:
   - Remove outdated branch reference in title
   - Add Epic 4 features:
     - Error UI (badge, error list, copy details, dismiss)
     - Preview truncation (show more/less toggle)
     - Protected page type-specific messages (chrome, file, extension)
   - Mark which tests are automated vs manual-only

2. Create smoke test script:
   - Add `pnpm smoke` command
   - Print formatted checklist to terminal with checkboxes
   - Include setup instructions (load unpacked extension)

3. Update `docs/dev/publishing-checklist.md`:
   - Reference `pnpm smoke` command in Build & QA section

## Acceptance Criteria

- [ ] `pnpm smoke` prints readable checklist to terminal
- [ ] Checklist covers all manual-only test scenarios
- [ ] Epic 4 features included (errors, preview, protected pages)
- [ ] Publishing checklist references the smoke command

## Design Notes

Proposed output format:

```text
MarkQuote Smoke Test Checklist (v1.1.0)
=======================================

Setup:
  pnpm build
  Load dist/ in chrome://extensions

Manual Tests (Playwright cannot automate):
  [ ] 1. Toolbar icon click (pinned) - copies selection
  [ ] 2. Keyboard shortcut (Alt+C) with icon pinned - opens popup
  [ ] 3. Protected chrome:// page - shows specific message
  [ ] 4. Protected file:// page - shows specific message

Feature Verification:
  [ ] 5. Error badge appears after failed copy
  [ ] 6. Error list displays in popup
  [ ] 7. "Copy details" generates markdown report
  [ ] 8. "Dismiss" clears errors and badge
  [ ] 9. Long preview shows truncated with "Show more"
  [ ] 10. "Show more/less" toggle works
  [ ] 11. Options page rule editing persists
  [ ] 12. Context menu copy works

Full details: docs/dev/smoke-test-plan.md
```
