# Chrome Web Store Credentials Handling

The Chrome Web Store Publish API relies on four values that are stored outside of git.

| Variable | Where to find it | Notes |
| --- | --- | --- |
| `EXTENSION_ID` | Chrome Web Store Developer Dashboard → *Items* → Select the MarkQuote listing. The 32-character ID appears in the URL (`.../detail/<id>`) and in the right-hand metadata panel. | If this is the first submission, create a draft item in the dashboard (Upload ZIP → choose an initial build). The ID is assigned immediately and stays fixed across versions. |
| `CLIENT_ID` | Google Cloud Console → APIs & Services → Credentials → OAuth 2.0 Client IDs. | Use the desktop-application client that has Chrome Web Store API access. |
| `CLIENT_SECRET` | Same page as `CLIENT_ID`; shown once when creating the client, but can be regenerated. | Regeneration invalidates previous refresh tokens. |
| `REFRESH_TOKEN` | Generated by running the OAuth consent flow (see below). | Each refresh token is tied to the `CLIENT_ID`/`CLIENT_SECRET`; revoke it if leaked. |

## Storage Plan
- Store credentials in the shared 1Password vault (entry: **MarkQuote / Chrome Web Store Publish**).
- Developers needing release access copy values into `.dev/secrets/chrome-web-store.env` (ignored by git).
- Use `scripts/publish/chrome-web-store.env.example` as the onboarding template.
- Rotate secrets whenever a maintainer leaves or quarterly—update 1Password and regenerate refresh
  token via the OAuth flow described in `chrome-web-store-publish-api.md`.

## Local Usage
For a fresh setup:
1. **Create the draft listing** on the Chrome Web Store Developer Dashboard and upload any build so the item receives its permanent `EXTENSION_ID`.
2. **Enable the Chrome Web Store API** for your Google Cloud project, then create a desktop OAuth client to obtain `CLIENT_ID` and `CLIENT_SECRET`.
3. **Generate `REFRESH_TOKEN`:** follow the consent flow in `chrome-web-store-publish-api.md` using the newly created client.

Place the four values in `.dev/secrets/chrome-web-store.env` (template in
`scripts/publish/chrome-web-store.env.example`). The publish script automatically sources it when
present; extra variables can still be exported manually before invocation when needed.

## Access Control
- Only maintainers (listed in `#team-maintainers` Slack channel) have 1Password access.
- Extension ID is safe to share internally but not publicly.
- Never commit `.dev/secrets` directory or raw credential values to git history.

## Incident Response
If credentials leak or access is revoked:
1. Revoke tokens via Google Cloud Console (`OAuth 2.0 Client IDs → Delete`).
2. Generate replacements following the Publish API guide.
3. Update secrets in 1Password and notify maintainers.
